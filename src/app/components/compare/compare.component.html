<div class="p-4">
  <div class="flex justify-content-between align-items-center mb-4">
    <h1 class="text-2xl font-bold text-primary">
      Comparateur d'Assurance Santé
    </h1>
    <div>
      <p-button
        label="Exemple"
        icon="pi pi-bolt"
        styleClass="p-button-outlined mr-2"
        (click)="loadExampleData()"
      ></p-button>
      <p-button
        label="Réinitialiser"
        icon="pi pi-refresh"
        styleClass="p-button-secondary"
        (click)="resetForm()"
      ></p-button>
    </div>
  </div>

  <div class="card">
    <p-toast></p-toast>

    <form [formGroup]="insuranceForm">
      <p-steps
        [model]="steps"
        [activeIndex]="activeIndex"
        [readonly]="false"
        (activeIndexChange)="goToStep($event)"
      ></p-steps>

      <div class="mt-4 wizard-content">
        <!-- Step 1: Informations personnelles -->
        <div *ngIf="activeIndex === 0" class="fadeIn">
          <div formGroupName="personalInfo">
            <div class="card p-4">
              <h2 class="text-xl font-medium mb-4">
                <i class="pi pi-user mr-2"></i>
                Informations personnelles
              </h2>

              <div class="grid">
                <div class="col-12 md:col-4">
                  <div class="field">
                    <label for="civilite" class="block mb-2">Civilité *</label>
                    <p-dropdown
                      id="civilite"
                      formControlName="civilite"
                      [options]="civiliteOptions"
                      optionLabel="label"
                      optionValue="value"
                      placeholder="Sélectionner"
                      [style]="{ width: '100%' }"
                    ></p-dropdown>
                    <small
                      *ngIf="
                        insuranceForm.get('personalInfo.civilite')?.invalid &&
                        insuranceForm.get('personalInfo.civilite')?.touched
                      "
                      class="p-error"
                      >La civilité est requise</small
                    >
                  </div>
                </div>

                <div class="col-12 md:col-4">
                  <div class="field">
                    <label for="nom" class="block mb-2">Nom *</label>
                    <input
                      id="nom"
                      formControlName="nom"
                      pInputText
                      class="w-full"
                      placeholder="Votre nom"
                    />
                    <small
                      *ngIf="
                        insuranceForm.get('personalInfo.nom')?.invalid &&
                        insuranceForm.get('personalInfo.nom')?.touched
                      "
                      class="p-error"
                      >Le nom est requis</small
                    >
                  </div>
                </div>

                <div class="col-12 md:col-4">
                  <div class="field">
                    <label for="prenom" class="block mb-2">Prénom *</label>
                    <input
                      id="prenom"
                      formControlName="prenom"
                      pInputText
                      class="w-full"
                      placeholder="Votre prénom"
                    />
                    <small
                      *ngIf="
                        insuranceForm.get('personalInfo.prenom')?.invalid &&
                        insuranceForm.get('personalInfo.prenom')?.touched
                      "
                      class="p-error"
                      >Le prénom est requis</small
                    >
                  </div>
                </div>

                <div class="col-12 md:col-4">
                  <div class="field">
                    <label for="dateNaissance" class="block mb-2"
                      >Date de naissance *</label
                    >
                    <p-calendar
                      id="dateNaissance"
                      formControlName="dateNaissance"
                      [showIcon]="true"
                      dateFormat="dd/mm/yy"
                      [style]="{ width: '100%' }"
                      placeholder="JJ/MM/AAAA"
                    ></p-calendar>
                    <small
                      *ngIf="
                        insuranceForm.get('personalInfo.dateNaissance')
                          ?.invalid &&
                        insuranceForm.get('personalInfo.dateNaissance')?.touched
                      "
                      class="p-error"
                      >La date de naissance est requise</small
                    >
                  </div>
                </div>

                <div class="col-12 md:col-4">
                  <div class="field">
                    <label for="codePostal" class="block mb-2"
                      >Code postal *</label
                    >
                    <input
                      id="codePostal"
                      formControlName="codePostal"
                      pInputText
                      class="w-full"
                      placeholder="75001"
                    />
                    <small
                      *ngIf="
                        insuranceForm.get('personalInfo.codePostal')?.invalid &&
                        insuranceForm.get('personalInfo.codePostal')?.touched
                      "
                      class="p-error"
                      >Code postal valide requis (5 chiffres)</small
                    >
                  </div>
                </div>

                <div class="col-12 md:col-4">
                  <div class="field">
                    <label for="ville" class="block mb-2">Ville *</label>
                    <input
                      id="ville"
                      formControlName="ville"
                      pInputText
                      class="w-full"
                      placeholder="Votre ville"
                    />
                    <small
                      *ngIf="
                        insuranceForm.get('personalInfo.ville')?.invalid &&
                        insuranceForm.get('personalInfo.ville')?.touched
                      "
                      class="p-error"
                      >La ville est requise</small
                    >
                  </div>
                </div>

                <div class="col-12 md:col-4">
                  <div class="field">
                    <label for="dateEffet" class="block mb-2">Date d'effet *</label>
                    <p-calendar
                      id="dateEffet"
                      formControlName="dateEffet"
                      dateFormat="dd/mm/yy"
                      [showIcon]="true"
                      placeholder="JJ/MM/AAAA"
                      [style]="{ width: '100%' }"
                    ></p-calendar>
                    <small
                      *ngIf="
                        insuranceForm.get('personalInfo.dateEffet')?.invalid &&
                        insuranceForm.get('personalInfo.dateEffet')?.touched
                      "
                      class="p-error"
                      >La date d'effet est requise.</small
                    >
                  </div>
                </div>

                <div class="col-12">
                  <div class="field">
                    <label for="adresse" class="block mb-2">Adresse *</label>
                    <input
                      id="adresse"
                      formControlName="adresse"
                      pInputText
                      class="w-full"
                      placeholder="123 Rue de la Paix"
                    />
                     <small
                      *ngIf="
                        insuranceForm.get('personalInfo.adresse')?.invalid &&
                        insuranceForm.get('personalInfo.adresse')?.touched
                      "
                      class="p-error"
                      >L'adresse est requise</small
                    >
                  </div>
                </div>

                <div class="col-12 md:col-4">
                  <div class="field">
                    <label for="complementAdresse" class="block mb-2">Complément d'adresse</label>
                    <input
                      id="complementAdresse"
                      formControlName="complementAdresse"
                      pInputText
                      class="w-full"
                      placeholder="Appartement, bâtiment..."
                    />
                  </div>
                </div>

                <div class="col-12 md:col-4">
                  <div class="field">
                    <label for="etatCivil" class="block mb-2">Etat civil *</label>
                    <p-dropdown
                      id="etatCivil"
                      formControlName="etatCivil"
                      [options]="EtatcivilOptions"
                      optionLabel="label"
                      optionValue="value"
                      placeholder="Sélectionner"
                      [style]="{ width: '100%' }"
                    ></p-dropdown>
                     <small
                      *ngIf="
                        insuranceForm.get('personalInfo.etatCivil')?.invalid &&
                        insuranceForm.get('personalInfo.etatCivil')?.touched
                      "
                      class="p-error"
                      >L'Etat civil est requis</small
                    >
                  </div>
                </div>

                <!-- Section Conjoint -->
                <div *ngIf="insuranceForm.get('personalInfo.etatCivil')?.value === 'marie' || insuranceForm.get('personalInfo.etatCivil')?.value === 'unionLibre'" formGroupName="conjoint" class="col-12">
                  <div class="card p-4 mt-4 border-1 border-gray-200">
                    <h3 class="text-lg font-medium mb-3">
                      <i class="pi pi-heart mr-2"></i>
                      Informations du conjoint
                    </h3>
                    <div class="grid">
                      <div class="col-12 md:col-4">
                        <div class="field">
                            <label for="conjointCivilite" class="block mb-2">Civilité</label>
                            <p-dropdown id="conjointCivilite" formControlName="civilite" [options]="civiliteOptions" optionLabel="label" optionValue="value" placeholder="- Choisir -" [style]="{ width: '100%' }"></p-dropdown>
                        </div>
                      </div>
                      <div class="col-12 md:col-4">
                        <div class="field">
                          <label for="conjointNom" class="block mb-2">Nom de famille</label>
                          <input id="conjointNom" formControlName="nom" pInputText class="w-full" placeholder="Nom de famille" />
                        </div>
                      </div>
                      <div class="col-12 md:col-4">
                        <div class="field">
                          <label for="conjointPrenom" class="block mb-2">Prénom</label>
                          <input id="conjointPrenom" formControlName="prenom" pInputText class="w-full" placeholder="Prénom" />
                        </div>
                      </div>
                      <div class="col-12 md:col-4">
                        <div class="field">
                          <label for="conjointEmail" class="block mb-2">Email</label>
                          <input id="conjointEmail" type="email" formControlName="email" pInputText class="w-full" placeholder="Email" />
                        </div>
                      </div>
                      <div class="col-12 md:col-4">
                        <div class="field">
                          <label for="conjointDateNaissance" class="block mb-2">Date de naissance</label>
                          <p-calendar id="conjointDateNaissance" formControlName="dateNaissance" [showIcon]="true" dateFormat="dd/mm/yy" [style]="{ width: '100%' }" placeholder="--/--/----"></p-calendar>
                        </div>
                      </div>
                      <div class="col-12 md:col-4">
                        <div class="field">
                            <label for="conjointRegime" class="block mb-2">Régime</label>
                            <p-dropdown id="conjointRegime" formControlName="regime" [options]="regimeOptions" optionLabel="label" optionValue="value" placeholder="- Choisir -" [style]="{ width: '100%' }"></p-dropdown>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Section Enfants -->
                <div class="col-12">
                    <div class="card p-4 mt-4 border-1 border-gray-200">
                        <h3 class="text-lg font-medium mb-3">
                            <i class="pi pi-users mr-2"></i>
                            Enfants à charge
                        </h3>
                        <div formArrayName="enfants">
                            <div *ngFor="let enfant of enfants.controls; let i = index" [formGroupName]="i" class="grid align-items-center p-2 mb-2 border-1 border-gray-200 rounded-md bg-gray-50">
                                <div class="col-12 md:col-4">
                                    <div class="field mb-0">
                                        <label [for]="'enfantCivilite' + i" class="block mb-2 text-sm">Civilité</label>
                                        <p-dropdown [id]="'enfantCivilite' + i" formControlName="civilite" [options]="civiliteOptions" optionLabel="label" optionValue="value" placeholder="- Choisir -" [style]="{ width: '100%' }"></p-dropdown>
                                    </div>
                                </div>
                                <div class="col-12 md:col-4">
                                    <div class="field mb-0">
                                        <label [for]="'enfantNom' + i" class="block mb-2 text-sm">Nom de famille</label>
                                        <input [id]="'enfantNom' + i" formControlName="nom" pInputText class="w-full" placeholder="Nom de famille" />
                                    </div>
                                </div>
                                <div class="col-12 md:col-4">
                                    <div class="field mb-0">
                                        <label [for]="'enfantPrenom' + i" class="block mb-2 text-sm">Prénom</label>
                                        <input [id]="'enfantPrenom' + i" formControlName="prenom" pInputText class="w-full" placeholder="Prénom" />
                                    </div>
                                </div>
                                <div class="col-12 md:col-6">
                                    <div class="field mb-0">
                                        <label [for]="'enfantDateNaissance' + i" class="block mb-2 text-sm">Date de naissance</label>
                                        <p-calendar [id]="'enfantDateNaissance' + i" formControlName="dateNaissance" [showIcon]="true" dateFormat="dd/mm/yy" [style]="{ width: '100%' }" placeholder="--/--/----"></p-calendar>
                                    </div>
                                </div>
                                <div class="col-12 md:col-5">
                                    <div class="field mb-0">
                                        <label [for]="'enfantRegime' + i" class="block mb-2 text-sm">Régime</label>
                                        <p-dropdown [id]="'enfantRegime' + i" formControlName="regime" [options]="regimeOptions" optionLabel="label" optionValue="value" placeholder="- Choisir -" [style]="{ width: '100%' }"></p-dropdown>
                                    </div>
                                </div>
                                <div class="col-12 md:col-1 flex align-items-center justify-content-end">
                                    <p-button icon="pi pi-trash" styleClass="p-button-danger p-button-text" (click)="removeEnfant(i)"></p-button>
                                </div>
                            </div>
                        </div>
                        <p-button label="Ajouter un enfant" icon="pi pi-plus" styleClass="p-button-outlined p-button-sm mt-2" (click)="addEnfant()"></p-button>
                    </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 2: Comparer -->
        <div *ngIf="activeIndex === 1" class="fadeIn">
          <div formGroupName="coverageSliders">
            <div class="card p-4">
              <h2 class="text-xl font-medium mb-4">
                <i class="pi pi-sliders-h mr-2"></i>
                Comparer les garanties
              </h2>
              <div class="grid">
                <!-- Hospitalisation -->
                <div class="col-12 md:col-6">
                  <div class="field">
                    <label for="hospitalisation" class="block mb-2">Hospitalisation</label>
                    <p-slider formControlName="hospitalisation" [min]="0" [max]="1000" [step]="5"></p-slider>
                    <span class="ml-2 font-bold">{{ insuranceForm.get('coverageSliders.hospitalisation')?.value }}%</span>
                  </div>
                </div>

                <!-- Chambre particulière -->
                <div class="col-12 md:col-6">
                  <div class="field">
                    <label for="chambreParticuliere" class="block mb-2">Chambre particulière</label>
                    <p-slider formControlName="chambreParticuliere" [min]="0" [max]="200" [step]="5"></p-slider>
                    <span class="ml-2 font-bold">{{ insuranceForm.get('coverageSliders.chambreParticuliere')?.value | currency:'EUR':'symbol':'1.0-0' }}</span>
                  </div>
                </div>

                <!-- Honoraires -->
                <div class="col-12 md:col-6">
                  <div class="field">
                    <label for="honoraires" class="block mb-2">Honoraires</label>
                    <p-slider formControlName="honoraires" [min]="0" [max]="500" [step]="5"></p-slider>
                    <span class="ml-2 font-bold">{{ insuranceForm.get('coverageSliders.honoraires')?.value }}%</span>
                  </div>
                </div>

                <!-- Dentaire -->
                <div class="col-12 md:col-6">
                  <div class="field">
                    <label for="dentaire" class="block mb-2">Dentaire</label>
                    <p-slider formControlName="dentaire" [min]="0" [max]="1000" [step]="5"></p-slider>
                    <span class="ml-2 font-bold">{{ insuranceForm.get('coverageSliders.dentaire')?.value }}%</span>
                  </div>
                </div>

                <!-- Orthodontie -->
                <div class="col-12 md:col-6">
                  <div class="field">
                    <label for="orthodontie" class="block mb-2">Orthodontie</label>
                    <p-slider formControlName="orthodontie" [min]="0" [max]="1000" [step]="5"></p-slider>
                    <span class="ml-2 font-bold">{{ insuranceForm.get('coverageSliders.orthodontie')?.value }}%</span>
                  </div>
                </div>

                <!-- Forfait dentaire -->
                <div class="col-12 md:col-6">
                  <div class="field">
                    <label for="forfaitDentaire" class="block mb-2">Forfait dentaire</label>
                    <p-slider formControlName="forfaitDentaire" [min]="0" [max]="1000" [step]="5"></p-slider>
                    <span class="ml-2 font-bold">{{ insuranceForm.get('coverageSliders.forfaitDentaire')?.value | currency:'EUR':'symbol':'1.0-0' }}</span>
                  </div>
                </div>

                <!-- Forfait optique -->
                <div class="col-12 md:col-6">
                  <div class="field">
                    <label for="forfaitOptique" class="block mb-2">Forfait optique</label>
                    <p-slider formControlName="forfaitOptique" [min]="0" [max]="1000" [step]="5"></p-slider>
                    <span class="ml-2 font-bold">{{ insuranceForm.get('coverageSliders.forfaitOptique')?.value | currency:'EUR':'symbol':'1.0-0' }}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 3: Résultats -->
        <div *ngIf="activeIndex === 2" class="fadeIn">
          <div class="card p-4">
            <h2 class="text-xl font-medium mb-4">
              <i class="pi pi-chart-bar mr-2"></i>
              Résultats de la comparaison
            </h2>
            
            <!-- Loading state -->
            <div *ngIf="submitting" class="text-center p-4">
              <p-progressSpinner></p-progressSpinner>
              <p class="mt-3">Calcul des tarifs en cours...</p>
            </div>

            <!-- No results state -->
            <div *ngIf="!hasResults() && !submitting" class="text-center p-4">
                <i class="pi pi-info-circle text-2xl text-primary mb-2"></i>
                <p>Vos résultats personnalisés apparaîtront ici.</p>
                <p class="text-sm text-500">Cliquez sur "Calculer les tarifs" pour lancer la comparaison.</p>
            </div>

            <!-- Results Grid -->
            <div *ngIf="hasResults() && !submitting" class="grid -m-2">
              <div
                *ngFor="let result of comparisonResults"
                class="col-12 md:col-6 lg:col-4 p-2"
              >
                <p-card styleClass="h-full flex flex-column">
                  <ng-template pTemplate="title">
                    <div class="text-center">{{ result.nomDeLOffre }}</div>
                  </ng-template>
                  <ng-template pTemplate="subtitle">
                    <div class="text-center my-3">
                      <span class="text-4xl font-bold">{{ (result.tarifMensuel ?? 0) | currency:'EUR':'symbol':'1.0-0' }}</span>
                      <span class="text-lg">/ mois</span>
                    </div>
                  </ng-template>
                  
                  <ul class="list-none p-0 m-0">
                    <li class="flex justify-content-between align-items-center py-2 border-bottom-1 border-200">
                      <span><i class="pi pi-plus-circle mr-2 text-primary"></i>Hospitalisation</span>
                      <span class="font-medium">{{ result.details.hospitalisation ?? 0 }}%</span>
                    </li>
                    <li class="flex justify-content-between align-items-center py-2 border-bottom-1 border-200">
                      <span>
                        <span class="mr-2 text-primary" style="display: inline-flex; vertical-align: -0.2em;">
                          <svg width="1.2em" height="1.2em" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9a1 1 0 1 0 0-2a1 1 0 0 0 0 2zm8 0a1 1 0 1 0 0-2a1 1 0 0 0 0 2zM4 18v-8a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8H4zm2-4h12"></path></svg>
                        </span>Chambre Particulière
                      </span>
                      <span class="font-medium">{{ (result.details.chambreParticuliere ?? 0) | currency:'EUR':'symbol':'1.0-0' }}</span>
                    </li>
                    <li class="flex justify-content-between align-items-center py-2 border-bottom-1 border-200">
                      <span>
                        <span class="mr-2 text-primary" style="display: inline-flex; vertical-align: -0.2em;">
                          <svg width="1.2em" height="1.2em" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 11a4 4 0 1 0 0-8a4 4 0 0 0 0 8zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"></path></svg>
                        </span>Soins Courants
                      </span>
                      <span class="font-medium">{{ result.details.honoraires ?? 0 }}%</span>
                    </li>
                    <li class="flex justify-content-between align-items-center py-2 border-bottom-1 border-200">
                      <span>
                        <span class="mr-2 text-primary" style="display: inline-flex; vertical-align: -0.2em;">
                          <svg width="1.2em" height="1.2em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7 21C7.55228 21 8 20.5523 8 20V19C8 18.4477 7.55228 18 7 18C6.44772 18 6 18.4477 6 19V20C6 20.5523 6.44772 21 7 21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M17 21C17.5523 21 18 20.5523 18 20V19C18 18.4477 17.5523 18 17 18C16.4477 18 16 18.4477 16 19V20C16 20.5523 16.4477 21 17 21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M6.99999 18C6.99999 15.7909 8.79085 14 11 14H13C15.2091 14 17 15.7909 17 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 14V11C12 9.34315 10.6569 8 9 8H8C6.34315 8 5 6.65685 5 5V3H19V5C19 6.65685 17.6569 8 16 8H15C13.3431 8 12 9.34315 12 11Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg>
                        </span>Dentaire
                      </span>
                      <span class="font-medium">{{ result.details.dentaire ?? 0 }}%</span>
                    </li>
                    <li class="flex justify-content-between align-items-center py-2 border-bottom-1 border-200">
                      <span>
                        <span class="mr-2 text-primary" style="display: inline-flex; vertical-align: -0.2em;">
                          <svg width="1.2em" height="1.2em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7 21C7.55228 21 8 20.5523 8 20V19C8 18.4477 7.55228 18 7 18C6.44772 18 6 18.4477 6 19V20C6 20.5523 6.44772 21 7 21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M17 21C17.5523 21 18 20.5523 18 20V19C18 18.4477 17.5523 18 17 18C16.4477 18 16 18.4477 16 19V20C16 20.5523 16.4477 21 17 21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M6.99999 18C6.99999 15.7909 8.79085 14 11 14H13C15.2091 14 17 15.7909 17 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 14V11C12 9.34315 10.6569 8 9 8H8C6.34315 8 5 6.65685 5 5V3H19V5C19 6.65685 17.6569 8 16 8H15C13.3431 8 12 9.34315 12 11Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M8 5.5H16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><rect x="9" y="10" width="2" height="2" rx="0.5" fill="currentColor"></rect><rect x="13" y="10" width="2" height="2" rx="0.5" fill="currentColor"></rect></svg>
                        </span>Orthodontie
                      </span>
                      <span class="font-medium">{{ result.details.orthodontie ?? 0 }}%</span>
                    </li>
                    <li class="flex justify-content-between align-items-center py-2 border-bottom-1 border-200">
                      <span><i class="pi pi-wallet mr-2 text-primary"></i>Forfait Dentaire</span>
                      <span class="font-medium">{{ (result.details.forfaitDentaire ?? 0) | currency:'EUR':'symbol':'1.0-0' }}</span>
                    </li>
                    <li class="flex justify-content-between align-items-center py-2">
                      <span><i class="pi pi-eye mr-2 text-primary"></i>Forfait Optique</span>
                      <span class="font-medium">{{ (result.details.forfaitOptique ?? 0) | currency:'EUR':'symbol':'1.0-0' }}</span>
                    </li>
                  </ul>

                  <ng-template pTemplate="footer">
                    <div class="mt-auto">
                      <p-button
                        label="Choisir cette offre"
                        icon="pi pi-check"
                        styleClass="p-button-success w-full"
                      ></p-button>
                    </div>
                  </ng-template>
                </p-card>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Navigation buttons -->
      <div class="flex justify-content-between mt-4">
        <p-button
          label="Précédent"
          icon="pi pi-chevron-left"
          styleClass="p-button-secondary"
          (click)="prevStep()"
          [disabled]="activeIndex === 0"
        ></p-button>

        <div>
          <p-button
            *ngIf="activeIndex === 0"
            label="Suivant"
            icon="pi pi-chevron-right"
            iconPos="right"
            (click)="nextStep()"
            [disabled]="!insuranceForm.get('personalInfo')?.valid"
          ></p-button>

          <p-button
            *ngIf="activeIndex === 1"
            label="Comparer"
            icon="pi pi-calculator"
            iconPos="right"
            (click)="submitComparison()"
            [loading]="submitting"
            [disabled]="!insuranceForm.valid"
          ></p-button>

          <p-button
            *ngIf="activeIndex === 2"
            label="Nouvelle comparaison"
            icon="pi pi-refresh"
            (click)="resetForm()"
          ></p-button>
        </div>
      </div>
    </form>
  </div>
</div>
